+------------------------------------------------------
	プレゼンメーカーの使い方
+------------------------------------------------------

おつです。鳥海です。
プレゼンの作成と配置を毎回手動でやるのに辟易したのでプログラムを作成しました。

使い方を記載するので最後まで読んでから、使ってください。

※txtを編集する際にはwindows標準のメモ帳は使わず、サクラエディタなどを利用してください。テンプレが文字化けします。

1.概要
+---------------------------------------------------------------------------
写真と必要な文言を設定し、実行するとプレゼン一式を作り出し、
それをデモ環境やリリース環境に配置するというプログラムです。

自分達でやる作業は以下のようになります。

	1.presenmakerフォルダ内にofficeXXX(XXXはオフィスのIDです)というフォルダを作成する。
	2.officeXXXの中に必要な画像を全て入れる。
	3.officeXXXの中にsetting.txtというファイルを作成し、使用するテンプレート、写真の文言を記載する。
	4.batを実行する。(exec_to_demo.batはデモ環境への反映、exec_to_release.batは本番環境への反映)

という流れです。

一応sampleとしてoffice100を同梱しておきました。

2.設定
+---------------------------------------------------------------------------
○globalsetting.txtの設定
	転送先やdbの設定などが記載されています。基本的な設定はしておきました。

	sendserverという設定値を設定する必要があります。(txtファイルの一番上に既に記載済み)
	この設定値は、出来上がったテンプレを環境に配置するかどうかという設定です。

	sendserver=false
	環境に配置せずにテンプレだけを作成する動作となります。確認したりする際に利用します。
	この状態でテンプレのテストなどを行い、大丈夫そうだと判断できたら、設定値をtrueにしてもらえればと思います。

	sendserver=true
	各テンプレを環境に配置します。プログラム終了後、everestで同期を行えば出来上がったテンプレを表示できるはずです。

○各officeフォルダのsetting.txtの設定
	使用するテンプレートを
	template=A
	という形式で設定します。A〜Kまでの値が設定可能です。

	事業所の名前を
	office_name=○○事業所
	という形式で設定します。これはテンプレのタイトルとなります。

	事業所のメインとなる写真のファイル名を
	main_ph=hogehoge.png
	という形式で設定します。一番トップの画像となります。
	ファイル名をphXX.pngとして(XXは数字)
	設定値をmain_ph=phXX.pngとすると
	everestの詳細画面上部の写真一覧に出力されます。
	
	各写真毎の設定を写真名_titleというような形式で記載します。
	例)
	officeXXXフォルダにph1.pngというファイルが合った場合
	ph1_title=浴場
	ph1_direction=left
	というように記載していきます。

	各写真の設定に関しては各テンプレートに必要な設定値が異なるので
	めんどくさいのでサンプルを用意しておきました。

	使いたいテンプレートの設定ファイルをsampleフォルダのsettingA〜K.txtから
	officeフォルダにコピーして利用するのが早いかと思います。
	※ファイル名はsettingA.txtなどからsetting.txtに変更するのを忘れないように！！

3.フォルダ構成
+---------------------------------------------------------------------------

	フォルダ構成は以下の通りです。
	この構成を崩すと動かなくなるので、ご注意を。

	presenmaker
		+finish
		+log
		+output
		+sample
		+template
		+[officeXXX]
		+...
		-exec_to_demo.bat
		-exec_to_release.bat
		-globalsetting.txt
		-presenmaker.jar
		-取扱説明書
		
	各フォルダ、ファイルの説明
	○finishフォルダ
		プレゼンが作成され、展開すべき環境に配置されたらこちらに移動します。
		globalsetting.txtの設定値がsendserver=falseとなっている場合は、finishに移動しません。
		6つ履歴を持つようにしてあるので、最新6つまでなら過去の分を確認することができます。

	○log
		実行時の各officeに対するログです。
		同様に6つ履歴を持つので、エラーがあった場合は確認してください。

	○output
		各officeの出来上がったプレゼンページが入っています。
		同様に6つ履歴を持つようにしてあるので、最新6つまでなら過去の分を確認することができます。
		
	○template
		元となるtemplateが入っています。ただ、プログラムで利用する形となっているため
		編集すると正しく動かなくなる可能性があるので、テンプレートを修正したい場合は教えてください。
		
	○officeXXX
		各オフィスのプレゼンを作成する元となるファイルを入れておきます。
	

4.注意点
+---------------------------------------------------------------------------
	※1:
		presenmakerフォルダのofficeXXXというフォルダを実行対象とするため、
		不必要なofficeXXXというフォルダは作成しないように。
		特に本番環境に対して実行するときは、必要なofficeのフォルダだけを入れるように。

	※2:
		exec_to_demo.batの実行時のログをdemo.log
		exec_to_release.batの実行時のログをrelease.log
		というファイルに出力するようにしています。
		不安になったらこのファイルをskypeに貼るかメールに添付してください。
		基本的には、
			at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
			at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
			at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
			at java.lang.reflect.Constructor.newInstance(Unknown Source)
			at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
			at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1116)
			at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:348)
			at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2391)
			at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2428)
			at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2213)
			at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:797)
			at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4
			
		こんなログが出ていなければ大丈夫なはずです。
		毎回実行毎に上書きを行うので、別途保存したい場合には別なファイル名にしてください。

	※3:
		globalsetting.txtのsendserver=trueとして実行した場合は
		成功したofficeXXXフォルダのみfinishに移動するので
		officeフォルダが残った場合には、logを確認してください。
		
	※4:
		setting.txtをsampleフォルダからコピーしてきた場合には
		ファイル名をsetting.txtという名称に変更することを忘れないように！
		
	※5:
		本番環境適用のためのbat(exec_to_release.bat)は実行前に念のため確認処理がはさんであります。
		実行して良い場合にはyをタイプしてenterキーを押してください。
		
	※6:
		今まで利用したことのないテンプレを利用する際には、
		globalsetting.txtのsendserver=trueとして実行し、
		出来上がったプレゼンページを確認するようにしてください。
		その際に思ったように出力できなければ教えてください。
